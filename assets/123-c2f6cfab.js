"use strict";(self.webpackChunkwebpack_vue3=self.webpackChunkwebpack_vue3||[]).push([[123],{4123:(e,l,a)=>{a.r(l),a.d(l,{default:()=>P});var t=a(5910),u=a(7375),i=a(3295);const o={__name:"cell-input",props:{modelValue:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(e,{emit:l}){const a=e,i=(0,u.iH)(null);function o(){const e=a.modelValue.trim();l("update:model-value",e)}return(0,t.bv)((()=>{a.autofocus&&i.value.focus()})),(l,a)=>{const u=(0,t.up)("el-input");return(0,t.wg)(),(0,t.j4)(u,{ref_key:"inputRef",ref:i,"model-value":e.modelValue,placeholder:"请输入","onUpdate:modelValue":a[0]||(a[0]=e=>l.$emit("update:model-value",e)),onBlur:o},null,8,["model-value"])}}},n={__name:"cell-date",props:{modelValue:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(e,{expose:l}){const a=e,o=(0,u.iH)(null);let n=null,r=null;const d=`date-picker-wrap-${Date.now()}`,s=`date-prper-${Date.now()}`;return(0,t.bv)((()=>{a.autofocus&&o.value.focus(),n=document.querySelector(`.${d}`),r=document.querySelector(`.${s}`)})),l({getDatePickerWrapEl:function(){return n},getPoppertEl:function(){return r}}),(l,a)=>{const u=(0,t.up)("el-date-picker");return(0,t.wg)(),(0,t.iD)("div",{class:(0,i.C_)(["date-picker-wrap",d])},[(0,t.Wm)(u,{ref_key:"dateRef",ref:o,"model-value":e.modelValue,type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期","popper-class":s,"onUpdate:modelValue":a[0]||(a[0]=e=>l.$emit("update:model-value",e))},null,8,["model-value"])],2)}}};var r=a(8972);const d=(0,r.Z)(n,[["__scopeId","data-v-98d1d730"]]),s={__name:"cell-select",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(e,{expose:l}){const a=e,i=(0,u.iH)(null);return(0,t.bv)((()=>{a.autofocus&&i.value.toggleMenu()})),l({getPoppertEl:function(){return i.value.popperPaneRef}}),(l,a)=>{const u=(0,t.up)("el-option"),o=(0,t.up)("el-select");return(0,t.wg)(),(0,t.j4)(o,{ref_key:"selectRef",ref:i,"model-value":e.modelValue,placeholder:"请选择",clearable:"",filterable:"","onUpdate:modelValue":a[0]||(a[0]=e=>l.$emit("update:model-value",e))},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.options,(e=>((0,t.wg)(),(0,t.j4)(u,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["model-value"])}}},c={__name:"textarea-popover",props:{modelValue:{type:String,default:""},autofocus:{type:Boolean,default:!0},virtualRef:{type:HTMLElement,default:void 0}},emits:["update:model-value"],setup(e,{expose:l,emit:a}){const i=e,o=(0,u.iH)(null),n=(0,u.iH)(null);function r(){const e=i.modelValue.trim();a("update:model-value",e)}return(0,t.bv)((()=>{i.autofocus&&n.value.focus()})),l({getPopoverEl:function(){return o.value.popperRef.contentRef}}),(l,a)=>{const u=(0,t.up)("el-input"),i=(0,t.up)("el-popover");return(0,t.wg)(),(0,t.j4)(i,{ref_key:"popoverRef",ref:o,visible:"","virtual-ref":e.virtualRef,trigger:"click","virtual-triggering":"",placement:"bottom-start",width:200},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{ref_key:"inputRef",ref:n,"model-value":e.modelValue,type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入","onUpdate:modelValue":a[0]||(a[0]=e=>l.$emit("update:model-value",e)),onBlur:r},null,8,["model-value"])])),_:1},8,["virtual-ref"])}}};var p=a(1513),m=a(1609);const v=e=>((0,t.dD)("data-v-311abf29"),e=e(),(0,t.Cn)(),e),f={class:"mg-top-10"},w=v((()=>(0,t._)("i",{class:"required"},"*",-1))),y=v((()=>(0,t._)("span",{class:"label"},"日期",-1))),_=v((()=>(0,t._)("i",{class:"required"},"*",-1))),k=v((()=>(0,t._)("span",{class:"label"},"名字",-1))),g=v((()=>(0,t._)("i",{class:"required"},"*",-1))),b=v((()=>(0,t._)("span",{class:"label"},"省份",-1))),h=v((()=>(0,t._)("i",{class:"required"},"*",-1))),W=v((()=>(0,t._)("span",{class:"label"},"城市",-1))),V=v((()=>(0,t._)("i",{class:"required"},"*",-1))),C=v((()=>(0,t._)("span",{class:"label"},"地址",-1))),D=v((()=>(0,t._)("span",{class:"label"},"邮编",-1))),R={key:1,class:"no-editor tooltip"},z=v((()=>(0,t._)("span",{class:"label"},"备注",-1))),H={key:1,class:"no-editor tooltip"},x={__name:"index",setup(e){const l=[{id:"1",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"2",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"3",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"4",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""}],a=(0,u.iH)(null),n=(0,u.iH)(!1),r=(0,u.iH)(null),v=(0,u.iH)(""),x=(0,u.iH)([{id:"1",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"2",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"3",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"4",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""}]),E=[{province:"黑龙江",citys:["哈尔滨","齐齐哈尔","鸡西","鹤岗"]},{province:"吉林",citys:["长春","通化","白山","四平"]},{province:"辽宁",citys:["辽阳","大连","鞍山","抚顺"]}];let U=[],S=[];const P=["date","name","province","city","address","zip","remark"],B=["date","name","province","city","address"],q=(0,u.iH)([]);x.value.forEach((e=>{F(e.id)}));const $=(0,u.iH)(""),T=(0,u.iH)(""),Y=(0,u.iH)("");let j=null,I=[];const M=(0,u.iH)(null),L=(0,u.iH)(null),A=(0,u.iH)(null);let Z=!0;const K=(0,u.iH)(null),N=(0,u.iH)(null);function F(e){let l={id:e};P.forEach((e=>{l[e]=""})),q.value.push(l)}function G(e,l){const a=q.value.find((l=>l.id===e));if(a)return a[l]}function J(e,l,a){const t=q.value.find((l=>l.id===e));t&&(t[l]=a)}function O(e,l,a,u){const i=l.property;if(P.includes(i))if("remark"===i&&N.value)Q();else if(!I[0]?.contains(u.target)){if(Q(),"province"===i)U=E.map((e=>e.province));else if("city"===i)if(e.province){const{citys:l}=E.find((l=>l.province===e.province));S=l}else S=[];else"remark"===i&&(N.value=a);n.value=!1,j=e,T.value=e.id,Y.value=i,$.value=e[i],Z=!0,(0,t.Y3)((()=>{I=[M.value],"date"===i?I.push(L.value.getPoppertEl()):"province"===i||"city"===i?I.push(A.value.getPoppertEl()):"remark"===i&&I.push(K.value.getPopoverEl())}))}}function Q(){0!==I.length&&(B.includes(Y.value)&&($.value?j[Y.value]!==$.value&&J(j.id,Y.value,"success"):J(j.id,Y.value,"error")),j[Y.value]=$.value,j=null,T.value="",Y.value="",$.value="",I=[],Z=!0,N.value=null)}function X(){if(!$.value)return void(j.city="");const e=j.city,{citys:l}=E.find((e=>e.province===$.value));l.includes(e)||(j.city="")}function ee(){"province"===Y.value&&X(),Q(),x.value.push({id:`${Date.now()}-${x.value.length+1}`,date:"",name:"",province:"",city:"",address:"",zip:"",remark:""}),j=x.value[x.value.length-1],T.value=j.id,Y.value="date",$.value=j.date,Z=!1,F(j.id),(0,t.Y3)((()=>{const e=a.value.layout.table.refs.tableBody;a.value.setScrollTop(e.clientHeight),a.value.setScrollLeft(0),I=[M.value,L.value.getPoppertEl()]}))}function le(e){let l=!1;x.value.forEach((e=>{for(const a in e)B.includes(a)&&!e[a]&&(l=!0,J(e.id,a,"error"))})),l?p.T.alert("必填项未填写","",{confirmButtonText:"确认",type:"error",callback:()=>{}}):new Promise((e=>{setTimeout((()=>{e()}),500)})).then((()=>{e&&e()}))}function ae(e){if(0===I.length)return;I.some((l=>l?.contains(e.target)))||("province"===Y.value&&X(),Q())}function te(e,l,a){const t=a.querySelector(".tooltip");if(!t)return;const u=document.createRange();u.setStart(t,0),u.setEnd(t,t.childNodes.length);const i=u.getBoundingClientRect().width,o=window.getComputedStyle(t);i+(parseInt(o.getPropertyValue("padding-left"))+parseInt(o.getPropertyValue("padding-right")))-t.getBoundingClientRect().width>.02&&(r.value=t,n.value=!0,v.value=t.innerText)}return(0,t.bv)((()=>{document.addEventListener("mouseup",ae)})),(0,t.Ah)((()=>{document.removeEventListener("mouseup",ae)})),(0,m.iS)(((e,a,t)=>{!function(){let e=!1;if(x.value.length!==l.length)return e=!0,e;let a=null;return x.value.some((t=>{if(a=l.find((e=>e.id===t.id)),!a)return e=!0,!0;for(const l in a)if(a[l]!==t[l])return e=!0,!0})),e}()?t():p.T.confirm("是否保存数据","",{confirmButtonText:"保存",cancelButtonText:"取消",type:"info",distinguishCancelAndClose:!0,callback:e=>{"confirm"===e?le((()=>{t()})):"cancel"===e&&t()}})})),(e,l)=>{const p=(0,t.up)("el-button"),m=(0,t.up)("el-row"),E=(0,t.up)("el-table-column"),P=(0,t.up)("EditPen"),B=(0,t.up)("el-icon"),q=(0,t.up)("el-table"),j=(0,t.up)("el-tooltip");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(m,{justify:"end"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{type:"primary",plain:"",onClick:ee},{default:(0,t.w5)((()=>[(0,t.Uk)("新增")])),_:1})])),_:1}),(0,t._)("div",f,[(0,t.Wm)(q,{ref_key:"tableRef",ref:a,data:x.value,border:"",stripe:"","max-height":400,onCellClick:O,onCellMouseEnter:te},{default:(0,t.w5)((()=>[(0,t.Wm)(E,{type:"index",fixed:"",label:"序号",width:"70"}),(0,t.Wm)(E,{prop:"date",label:"日期","min-width":"140","class-name":"editor-column"},{header:(0,t.w5)((()=>[w,y,(0,t.Wm)(B,null,{default:(0,t.w5)((()=>[(0,t.Wm)(P)])),_:1})])),default:(0,t.w5)((({row:e})=>[T.value===e.id&&"date"===Y.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:M,class:"editor"},[(0,t.Wm)(d,{ref_key:"cellDateRef",ref:L,modelValue:$.value,"onUpdate:modelValue":l[0]||(l[0]=e=>$.value=e),autofocus:(0,u.SU)(Z)},null,8,["modelValue","autofocus"])],512)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:(0,i.C_)(["no-editor","tooltip",G(e.id,"date")])},(0,i.zw)(e.date),3))])),_:1}),(0,t.Wm)(E,{prop:"name",label:"名字","min-width":"120","class-name":"editor-column"},{header:(0,t.w5)((()=>[_,k,(0,t.Wm)(B,null,{default:(0,t.w5)((()=>[(0,t.Wm)(P)])),_:1})])),default:(0,t.w5)((({row:e})=>[T.value===e.id&&"name"===Y.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:M,class:"editor"},[(0,t.Wm)(o,{modelValue:$.value,"onUpdate:modelValue":l[1]||(l[1]=e=>$.value=e)},null,8,["modelValue"])],512)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:(0,i.C_)(["no-editor","tooltip",G(e.id,"name")])},(0,i.zw)(e.name),3))])),_:1}),(0,t.Wm)(E,{prop:"province",label:"省份","min-width":"120","class-name":"editor-column"},{header:(0,t.w5)((()=>[g,b,(0,t.Wm)(B,null,{default:(0,t.w5)((()=>[(0,t.Wm)(P)])),_:1})])),default:(0,t.w5)((({row:e})=>[T.value===e.id&&"province"===Y.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:M,class:"editor"},[(0,t.Wm)(s,{ref_key:"cellSelectRef",ref:A,modelValue:$.value,"onUpdate:modelValue":l[2]||(l[2]=e=>$.value=e),options:(0,u.SU)(U)},null,8,["modelValue","options"])],512)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:(0,i.C_)(["no-editor","tooltip",G(e.id,"province")])},(0,i.zw)(e.province),3))])),_:1}),(0,t.Wm)(E,{prop:"city",label:"城市","min-width":"120","class-name":"editor-column"},{header:(0,t.w5)((()=>[h,W,(0,t.Wm)(B,null,{default:(0,t.w5)((()=>[(0,t.Wm)(P)])),_:1})])),default:(0,t.w5)((({row:e})=>[T.value===e.id&&"city"===Y.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:M,class:"editor"},[(0,t.Wm)(s,{ref_key:"cellSelectRef",ref:A,modelValue:$.value,"onUpdate:modelValue":l[3]||(l[3]=e=>$.value=e),options:(0,u.SU)(S)},null,8,["modelValue","options"])],512)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:(0,i.C_)(["no-editor","tooltip",G(e.id,"city")])},(0,i.zw)(e.city),3))])),_:1}),(0,t.Wm)(E,{prop:"address",label:"地址","min-width":"170","class-name":"editor-column"},{header:(0,t.w5)((()=>[V,C,(0,t.Wm)(B,null,{default:(0,t.w5)((()=>[(0,t.Wm)(P)])),_:1})])),default:(0,t.w5)((({row:e})=>[T.value===e.id&&"address"===Y.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:M,class:"editor"},[(0,t.Wm)(o,{modelValue:$.value,"onUpdate:modelValue":l[4]||(l[4]=e=>$.value=e)},null,8,["modelValue"])],512)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:(0,i.C_)(["no-editor","tooltip",G(e.id,"address")])},(0,i.zw)(e.address),3))])),_:1}),(0,t.Wm)(E,{prop:"zip",label:"邮编","min-width":"120","class-name":"editor-column"},{header:(0,t.w5)((()=>[D,(0,t.Wm)(B,null,{default:(0,t.w5)((()=>[(0,t.Wm)(P)])),_:1})])),default:(0,t.w5)((({row:e})=>[T.value===e.id&&"zip"===Y.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:M,class:"editor"},[(0,t.Wm)(o,{modelValue:$.value,"onUpdate:modelValue":l[5]||(l[5]=e=>$.value=e)},null,8,["modelValue"])],512)):((0,t.wg)(),(0,t.iD)("div",R,(0,i.zw)(e.zip),1))])),_:1}),(0,t.Wm)(E,{prop:"remark",label:"备注","min-width":"180","class-name":"editor-column"},{header:(0,t.w5)((()=>[z,(0,t.Wm)(B,null,{default:(0,t.w5)((()=>[(0,t.Wm)(P)])),_:1})])),default:(0,t.w5)((({row:e})=>[T.value===e.id&&"remark"===Y.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:M,class:"popover-edit"},(0,i.zw)(e.remark),513)):((0,t.wg)(),(0,t.iD)("div",H,(0,i.zw)(e.remark),1))])),_:1}),(0,t.Wm)(E,{label:"操作","min-width":"70",fixed:"right"},{default:(0,t.w5)((({row:e})=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(p,{link:"",type:"primary",onClick:l=>function(e){const l=x.value.findIndex((l=>l.id===e));l>=0&&x.value.splice(l,1)}(e.id)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"]),(0,t.Wm)(j,{visible:n.value,"onUpdate:visible":l[6]||(l[6]=e=>n.value=e),"virtual-ref":r.value,"virtual-triggering":"",content:v.value,placement:"top",teleported:!1},null,8,["visible","virtual-ref","content"]),N.value?((0,t.wg)(),(0,t.j4)(c,{key:0,ref_key:"textareaPopoverRef",ref:K,modelValue:$.value,"onUpdate:modelValue":l[7]||(l[7]=e=>$.value=e),"virtual-ref":N.value},null,8,["modelValue","virtual-ref"])):(0,t.kq)("v-if",!0)]),(0,t.Wm)(m,{justify:"center",class:"mg-top-20"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{type:"primary",onClick:l[8]||(l[8]=e=>le())},{default:(0,t.w5)((()=>[(0,t.Uk)("保存")])),_:1})])),_:1})])}}},E=(0,r.Z)(x,[["__scopeId","data-v-311abf29"]]),U=(e=>((0,t.dD)("data-v-30921bf0"),e=e(),(0,t.Cn)(),e))((()=>(0,t._)("div",{class:"title"},"表格编辑",-1))),S={__name:"index",setup:e=>(e,l)=>{const a=(0,t.up)("el-tab-pane"),u=(0,t.up)("el-tabs");return(0,t.wg)(),(0,t.iD)(t.HY,null,[U,(0,t.Wm)(u,{"model-value":"1"},{default:(0,t.w5)((()=>[(0,t.Wm)(a,{label:"单元格编辑",name:"1"},{default:(0,t.w5)((()=>[(0,t.Wm)(E)])),_:1}),(0,t.kq)(' <el-tab-pane label="单元格编辑2" name="2" lazy>\r\n      <CellEdit2 />\r\n    </el-tab-pane> ')])),_:1})],64)}},P=(0,r.Z)(S,[["__scopeId","data-v-30921bf0"]])}}]);
//# sourceMappingURL=123-c2f6cfab.js.map