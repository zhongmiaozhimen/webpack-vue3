"use strict";(self.webpackChunkwebpack_vue3=self.webpackChunkwebpack_vue3||[]).push([[123],{4123:(e,l,a)=>{a.r(l),a.d(l,{default:()=>q});var t=a(5910),u=a(7375),i=a(3295),o=a(692);const n={__name:"cell-input",props:{modelValue:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(e,{emit:l}){const a=e,i=(0,u.iH)(null);function o(){const e=a.modelValue.trim();l("update:model-value",e)}return(0,t.bv)((()=>{a.autofocus&&i.value.focus()})),(l,a)=>{const u=(0,t.up)("el-input");return(0,t.wg)(),(0,t.j4)(u,{ref_key:"inputRef",ref:i,"model-value":e.modelValue,placeholder:"请输入","onUpdate:modelValue":a[0]||(a[0]=e=>l.$emit("update:model-value",e)),onBlur:o},null,8,["model-value"])}}},r={__name:"cell-date",props:{modelValue:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(e,{expose:l}){const a=e,o=(0,u.iH)(null);let n=null,r=null;const d=`date-picker-wrap-${Date.now()}`,s=`date-prper-${Date.now()}`;return(0,t.bv)((()=>{a.autofocus&&o.value.focus(),n=document.querySelector(`.${d}`),r=document.querySelector(`.${s}`)})),l({getDatePickerWrapEl:function(){return n},getPoppertEl:function(){return r}}),(l,a)=>{const u=(0,t.up)("el-date-picker");return(0,t.wg)(),(0,t.iD)("div",{class:(0,i.C_)(["date-picker-wrap",d])},[(0,t.Wm)(u,{ref_key:"dateRef",ref:o,"model-value":e.modelValue,type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期","popper-class":s,"onUpdate:modelValue":a[0]||(a[0]=e=>l.$emit("update:model-value",e))},null,8,["model-value"])],2)}}};var d=a(8972);const s=(0,d.Z)(r,[["__scopeId","data-v-98d1d730"]]),c={__name:"cell-select",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(e,{expose:l}){const a=e,i=(0,u.iH)(null);return(0,t.bv)((()=>{a.autofocus&&i.value.toggleMenu()})),l({getPoppertEl:function(){return i.value.popperPaneRef}}),(l,a)=>{const u=(0,t.up)("el-option"),o=(0,t.up)("el-select");return(0,t.wg)(),(0,t.j4)(o,{ref_key:"selectRef",ref:i,"model-value":e.modelValue,placeholder:"请选择",clearable:"",filterable:"","onUpdate:modelValue":a[0]||(a[0]=e=>l.$emit("update:model-value",e))},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.options,(e=>((0,t.wg)(),(0,t.j4)(u,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["model-value"])}}},p={__name:"textarea-popover",props:{modelValue:{type:String,default:""},autofocus:{type:Boolean,default:!0},virtualRef:{type:HTMLElement,default:void 0}},emits:["update:model-value"],setup(e,{expose:l,emit:a}){const i=e,o=(0,u.iH)(null),n=(0,u.iH)(null);function r(){const e=i.modelValue.trim();a("update:model-value",e)}return(0,t.bv)((()=>{i.autofocus&&n.value.focus()})),l({getPopoverEl:function(){return o.value.popperRef.contentRef}}),(l,a)=>{const u=(0,t.up)("el-input"),i=(0,t.up)("el-popover");return(0,t.wg)(),(0,t.j4)(i,{ref_key:"popoverRef",ref:o,visible:"","virtual-ref":e.virtualRef,trigger:"click","virtual-triggering":"",placement:"bottom-start",width:200},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{ref_key:"inputRef",ref:n,"model-value":e.modelValue,type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入","onUpdate:modelValue":a[0]||(a[0]=e=>l.$emit("update:model-value",e)),onBlur:r},null,8,["model-value"])])),_:1},8,["virtual-ref"])}}};var v=a(1513),m=a(1609);const f=e=>((0,t.dD)("data-v-19c4134d"),e=e(),(0,t.Cn)(),e),w={class:"mg-top-10"},y=f((()=>(0,t._)("i",{class:"required"},"*",-1))),_=f((()=>(0,t._)("span",{class:"label"},"日期",-1))),k=f((()=>(0,t._)("i",{class:"required"},"*",-1))),g=f((()=>(0,t._)("span",{class:"label"},"名字",-1))),b=f((()=>(0,t._)("i",{class:"required"},"*",-1))),h=f((()=>(0,t._)("span",{class:"label"},"省份",-1))),W=f((()=>(0,t._)("i",{class:"required"},"*",-1))),V=f((()=>(0,t._)("span",{class:"label"},"城市",-1))),C=f((()=>(0,t._)("i",{class:"required"},"*",-1))),D=f((()=>(0,t._)("span",{class:"label"},"地址",-1))),R=f((()=>(0,t._)("span",{class:"label"},"邮编",-1))),H={key:1,class:"no-editor tooltip"},z=f((()=>(0,t._)("span",{class:"label"},"备注",-1))),x={key:1,class:"no-editor tooltip"},E={class:"tooltip-wrap"},U={__name:"index",setup(e){const l=[{id:"1",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"2",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"3",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"4",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""}],a=(0,u.iH)(null),r=(0,u.iH)(!1),d=(0,u.iH)(null),f=(0,u.iH)(""),U=(0,u.iH)(!0),S=(0,u.iH)([{id:"1",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"2",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"3",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{id:"4",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""}]),P=[{province:"黑龙江",citys:["哈尔滨","齐齐哈尔","鸡西","鹤岗"]},{province:"吉林",citys:["长春","通化","白山","四平"]},{province:"辽宁",citys:["辽阳","大连","鞍山","抚顺"]}];let B=[],q=[];const $=["date","name","province","city","address","zip","remark"],T=["date","name","province","city","address"],Y=(0,u.iH)([]);S.value.forEach((e=>{O(e.id)}));const j=(0,u.iH)(""),I=(0,u.iH)(""),M=(0,u.iH)("");let L=null,A=[];const Z=(0,u.iH)(null),F=(0,u.iH)(null),K=(0,u.iH)(null);let N=!0;const G=(0,u.iH)(null),J=(0,u.iH)(null);function O(e){let l={id:e};$.forEach((e=>{l[e]=""})),Y.value.push(l)}function Q(e,l){const a=Y.value.find((l=>l.id===e));if(a)return a[l]}function X(e,l,a){const t=Y.value.find((l=>l.id===e));t&&(t[l]=a)}function ee(e,l,a,u){const i=l.property;if($.includes(i))if("remark"===i&&J.value)le();else if(!A[0]?.contains(u.target)){if(le(),"province"===i)B=P.map((e=>e.province));else if("city"===i)if(e.province){const{citys:l}=P.find((l=>l.province===e.province));q=l}else q=[];else"remark"===i&&(J.value=a);U.value=!1,L=e,I.value=e.id,M.value=i,j.value=e[i],N=!0,(0,t.Y3)((()=>{A=[Z.value],"date"===i?A.push(F.value.getPoppertEl()):"province"===i||"city"===i?A.push(K.value.getPoppertEl()):"remark"===i&&A.push(G.value.getPopoverEl())}))}}function le(){0!==A.length&&(T.includes(M.value)&&(j.value?L[M.value]!==j.value&&X(L.id,M.value,"success"):X(L.id,M.value,"error")),L[M.value]=j.value,L=null,I.value="",M.value="",j.value="",A=[],N=!0,J.value=null)}function ae(){if(!j.value)return void(L.city="");const e=L.city,{citys:l}=P.find((e=>e.province===j.value));l.includes(e)||(L.city="")}function te(){"province"===M.value&&ae(),le(),S.value.push({id:`${Date.now()}-${S.value.length+1}`,date:"",name:"",province:"",city:"",address:"",zip:"",remark:""}),L=S.value[S.value.length-1],I.value=L.id,M.value="date",j.value=L.date,N=!1,O(L.id),(0,t.Y3)((()=>{const e=a.value.layout.table.refs.tableBody;a.value.setScrollTop(e.clientHeight),a.value.setScrollLeft(0),A=[Z.value,F.value.getPoppertEl()]}))}function ue(e){let l=!1;S.value.forEach((e=>{for(const a in e)T.includes(a)&&!e[a]&&(l=!0,X(e.id,a,"error"))})),l?v.T.alert("必填项未填写","",{confirmButtonText:"确认",type:"error",callback:()=>{}}):new Promise((e=>{setTimeout((()=>{e()}),500)})).then((()=>{e&&e()}))}function ie(e){if(0===A.length)return;A.some((l=>l?.contains(e.target)))||("province"===M.value&&ae(),le())}function oe(e,l,a){const t=a.querySelector(".tooltip");if(!t)return;const u=document.createRange();u.setStart(t,0),u.setEnd(t,t.childNodes.length);const i=u.getBoundingClientRect().width,o=window.getComputedStyle(t);i+(parseInt(o.getPropertyValue("padding-left"))+parseInt(o.getPropertyValue("padding-right")))-t.getBoundingClientRect().width>.02&&(U.value=!0,d.value=t,r.value=!0,f.value=t.innerText)}function ne(){r.value=!1,f.value="",d.value=null}return(0,t.bv)((()=>{document.addEventListener("mouseup",ie)})),(0,t.Ah)((()=>{document.removeEventListener("mouseup",ie)})),(0,m.iS)(((e,a,t)=>{!function(){let e=!1;if(S.value.length!==l.length)return e=!0,e;let a=null;return S.value.some((t=>{if(a=l.find((e=>e.id===t.id)),!a)return e=!0,!0;for(const l in a)if(a[l]!==t[l])return e=!0,!0})),e}()?t():v.T.confirm("是否保存数据","",{confirmButtonText:"保存",cancelButtonText:"取消",type:"info",distinguishCancelAndClose:!0,callback:e=>{"confirm"===e?ue((()=>{t()})):"cancel"===e&&t()}})})),(e,l)=>{const v=(0,t.up)("el-button"),m=(0,t.up)("el-row"),P=(0,t.up)("el-table-column"),$=(0,t.up)("EditPen"),T=(0,t.up)("el-icon"),Y=(0,t.up)("el-table"),L=(0,t.up)("el-tooltip");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(m,{justify:"end"},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{type:"primary",plain:"",onClick:te},{default:(0,t.w5)((()=>[(0,t.Uk)("新增")])),_:1})])),_:1}),(0,t._)("div",w,[(0,t.Wm)(Y,{ref_key:"tableRef",ref:a,data:S.value,border:"",stripe:"","max-height":400,onCellClick:ee,onCellMouseEnter:oe,onCellMouseLeave:ne},{default:(0,t.w5)((()=>[(0,t.Wm)(P,{type:"index",fixed:"",label:"序号",width:"70"}),(0,t.Wm)(P,{prop:"date",label:"日期","min-width":"140","class-name":"editor-column"},{header:(0,t.w5)((()=>[y,_,(0,t.Wm)(T,null,{default:(0,t.w5)((()=>[(0,t.Wm)($)])),_:1})])),default:(0,t.w5)((({row:e})=>[I.value===e.id&&"date"===M.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:Z,class:"editor"},[(0,t.Wm)(s,{ref_key:"cellDateRef",ref:F,modelValue:j.value,"onUpdate:modelValue":l[0]||(l[0]=e=>j.value=e),autofocus:(0,u.SU)(N)},null,8,["modelValue","autofocus"])],512)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:(0,i.C_)(["no-editor","tooltip",Q(e.id,"date")])},(0,i.zw)(e.date),3))])),_:1}),(0,t.Wm)(P,{prop:"name",label:"名字","min-width":"120","class-name":"editor-column"},{header:(0,t.w5)((()=>[k,g,(0,t.Wm)(T,null,{default:(0,t.w5)((()=>[(0,t.Wm)($)])),_:1})])),default:(0,t.w5)((({row:e})=>[I.value===e.id&&"name"===M.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:Z,class:"editor"},[(0,t.Wm)(n,{modelValue:j.value,"onUpdate:modelValue":l[1]||(l[1]=e=>j.value=e)},null,8,["modelValue"])],512)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:(0,i.C_)(["no-editor","tooltip",Q(e.id,"name")])},(0,i.zw)(e.name),3))])),_:1}),(0,t.Wm)(P,{prop:"province",label:"省份","min-width":"120","class-name":"editor-column"},{header:(0,t.w5)((()=>[b,h,(0,t.Wm)(T,null,{default:(0,t.w5)((()=>[(0,t.Wm)($)])),_:1})])),default:(0,t.w5)((({row:e})=>[I.value===e.id&&"province"===M.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:Z,class:"editor"},[(0,t.Wm)(c,{ref_key:"cellSelectRef",ref:K,modelValue:j.value,"onUpdate:modelValue":l[2]||(l[2]=e=>j.value=e),options:(0,u.SU)(B)},null,8,["modelValue","options"])],512)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:(0,i.C_)(["no-editor","tooltip",Q(e.id,"province")])},(0,i.zw)(e.province),3))])),_:1}),(0,t.Wm)(P,{prop:"city",label:"城市","min-width":"120","class-name":"editor-column"},{header:(0,t.w5)((()=>[W,V,(0,t.Wm)(T,null,{default:(0,t.w5)((()=>[(0,t.Wm)($)])),_:1})])),default:(0,t.w5)((({row:e})=>[I.value===e.id&&"city"===M.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:Z,class:"editor"},[(0,t.Wm)(c,{ref_key:"cellSelectRef",ref:K,modelValue:j.value,"onUpdate:modelValue":l[3]||(l[3]=e=>j.value=e),options:(0,u.SU)(q)},null,8,["modelValue","options"])],512)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:(0,i.C_)(["no-editor","tooltip",Q(e.id,"city")])},(0,i.zw)(e.city),3))])),_:1}),(0,t.Wm)(P,{prop:"address",label:"地址","min-width":"170","class-name":"editor-column"},{header:(0,t.w5)((()=>[C,D,(0,t.Wm)(T,null,{default:(0,t.w5)((()=>[(0,t.Wm)($)])),_:1})])),default:(0,t.w5)((({row:e})=>[I.value===e.id&&"address"===M.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:Z,class:"editor"},[(0,t.Wm)(n,{modelValue:j.value,"onUpdate:modelValue":l[4]||(l[4]=e=>j.value=e)},null,8,["modelValue"])],512)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:(0,i.C_)(["no-editor","tooltip",Q(e.id,"address")])},(0,i.zw)(e.address),3))])),_:1}),(0,t.Wm)(P,{prop:"zip",label:"邮编","min-width":"120","class-name":"editor-column"},{header:(0,t.w5)((()=>[R,(0,t.Wm)(T,null,{default:(0,t.w5)((()=>[(0,t.Wm)($)])),_:1})])),default:(0,t.w5)((({row:e})=>[I.value===e.id&&"zip"===M.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:Z,class:"editor"},[(0,t.Wm)(n,{modelValue:j.value,"onUpdate:modelValue":l[5]||(l[5]=e=>j.value=e)},null,8,["modelValue"])],512)):((0,t.wg)(),(0,t.iD)("div",H,(0,i.zw)(e.zip),1))])),_:1}),(0,t.Wm)(P,{prop:"remark",label:"备注","min-width":"180","class-name":"editor-column"},{header:(0,t.w5)((()=>[z,(0,t.Wm)(T,null,{default:(0,t.w5)((()=>[(0,t.Wm)($)])),_:1})])),default:(0,t.w5)((({row:e})=>[I.value===e.id&&"remark"===M.value?((0,t.wg)(),(0,t.iD)("div",{key:0,ref_key:"editCellRef",ref:Z,class:"popover-edit"},(0,i.zw)(e.remark),513)):((0,t.wg)(),(0,t.iD)("div",x,(0,i.zw)(e.remark),1))])),_:1}),(0,t.Wm)(P,{label:"操作","min-width":"70",fixed:"right"},{default:(0,t.w5)((({row:e})=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v,{link:"",type:"primary",onClick:l=>function(e){const l=S.value.findIndex((l=>l.id===e));l>=0&&S.value.splice(l,1)}(e.id)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"]),(0,t.wy)((0,t._)("div",E,[(0,t.Wm)(L,{visible:r.value,"onUpdate:visible":l[6]||(l[6]=e=>r.value=e),"virtual-ref":d.value,"virtual-triggering":"",content:f.value,placement:"top",teleported:!1},null,8,["visible","virtual-ref","content"])],512),[[o.F8,U.value]]),J.value?((0,t.wg)(),(0,t.j4)(p,{key:0,ref_key:"textareaPopoverRef",ref:G,modelValue:j.value,"onUpdate:modelValue":l[7]||(l[7]=e=>j.value=e),"virtual-ref":J.value},null,8,["modelValue","virtual-ref"])):(0,t.kq)("v-if",!0)]),(0,t.Wm)(m,{justify:"center",class:"mg-top-20"},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{type:"primary",onClick:l[8]||(l[8]=e=>ue())},{default:(0,t.w5)((()=>[(0,t.Uk)("保存")])),_:1})])),_:1})])}}},S=(0,d.Z)(U,[["__scopeId","data-v-19c4134d"]]),P=(e=>((0,t.dD)("data-v-30921bf0"),e=e(),(0,t.Cn)(),e))((()=>(0,t._)("div",{class:"title"},"表格编辑",-1))),B={__name:"index",setup:e=>(e,l)=>{const a=(0,t.up)("el-tab-pane"),u=(0,t.up)("el-tabs");return(0,t.wg)(),(0,t.iD)(t.HY,null,[P,(0,t.Wm)(u,{"model-value":"1"},{default:(0,t.w5)((()=>[(0,t.Wm)(a,{label:"单元格编辑",name:"1"},{default:(0,t.w5)((()=>[(0,t.Wm)(S)])),_:1}),(0,t.kq)(' <el-tab-pane label="单元格编辑2" name="2" lazy>\r\n      <CellEdit2 />\r\n    </el-tab-pane> ')])),_:1})],64)}},q=(0,d.Z)(B,[["__scopeId","data-v-30921bf0"]])}}]);
//# sourceMappingURL=123-a054859c.js.map